"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[601],{9601:(e,t,n)=>{n.r(t),n.d(t,{default:()=>P});var a=n(2982),r=n(5671),c=n(3144),s=n(136),o=n(2963),i=n(1120),u=n(4687),l=n.n(u),f=n(9526),d=n(7586);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,a=(0,i.default)(e);if(t){var r=(0,i.default)(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return(0,o.default)(this,n)}}var h=n(4653),m=h.Configuration,g=h.OpenAIApi,v=function(e){(0,s.default)(n,e);var t=p(n);function n(){var e;(0,r.default)(this,n);for(var c=arguments.length,s=new Array(c),o=0;o<c;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={url:"",extractedData:null,chatInput:"",chats:[],placeholder:"",isDataExtracted:!1,openai:null,placeholder:"Ask questions about the extracted data..."},e.componentDidMount=function(){var t;return l().async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l().awrap(e.CreateOpenAIModel());case 2:return n.next=4,l().awrap(e.extractDataFromPage("https://jsonplaceholder.typicode.com/"));case 4:t=n.sent,e.sendPageContentToModel(t),e.setState({extractedData:t,isDataExtracted:!0});case 7:case"end":return n.stop()}}),null,null,null,Promise)},e.handleUrlSubmit=function(t){var n,a;return l().async((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.url,t.next=3,l().awrap(e.extractDataFromPage(n));case 3:a=t.sent,e.setState({extractedData:a,isDataExtracted:!0,chats:[]},(function(){e.sendPageContentToModel(a)}));case 5:case"end":return t.stop()}}),null,null,null,Promise)},e.CreateOpenAIModel=function(){var t,n,a,r;return l().async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,l().awrap(d.default.getOpenAIAPI());case 2:t=c.sent,n=Array.isArray(t)?t.join(""):t,delete(a=new m({apiKey:n})).baseOptions.headers["User-Agent"],r=new g(a),e.setState({openai:r});case 8:case"end":return c.stop()}}),null,null,null,Promise)},e.sendPageContentToModel=function(t){var n,r,c;return l().async((function(s){for(;;)switch(s.prev=s.next){case 0:return n="MUST READ NOTE: The person chatting with you thinks they are talking to \n                        the content of "+e.state.url+". Please interact with them as if you \n                        were the content of "+e.state.url+" and chat with them. Find attached \n                        the content of "+e.state.url+": \n\n"+t.paragraphs+"\n\nUser:",r=[{role:"user",content:n}],s.next=4,l().awrap(e.state.openai.createChatCompletion({model:"gpt-3.5-turbo",messages:r}));case 4:c=s.sent,c.data.choices[0].message.content,e.setState((function(e){return{chats:[].concat((0,a.default)(e.chats),[r[0]])}}));case 7:case"end":return s.stop()}}),null,null,null,Promise)},e.extractDataFromPage=function(e){var t,n,a,r,c,s;return l().async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,l().awrap(fetch(e));case 3:return t=o.sent,o.next=6,l().awrap(t.text());case 6:return n=o.sent,a=new DOMParser,r=a.parseFromString(n,"text/html"),c=Array.from(r.querySelectorAll("p")).map((function(e){return e.textContent})),s={paragraphs:c},o.abrupt("return",s);case 14:return o.prev=14,o.t0=o.catch(0),console.error("Error extracting data:",o.t0),o.abrupt("return",{});case 18:case"end":return o.stop()}}),null,null,[[0,14]],Promise)},e.handleSendMessage=function(){var t,n;return l().async((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.state.chatInput,e.state.isDataExtracted&&(n={role:"user",content:t},e.setState((function(e){return{chats:[].concat((0,a.default)(e.chats),[n]),chatInput:""}}),(function(){var t,n,r;return l().async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,l().awrap(e.state.openai.createChatCompletion({model:"gpt-3.5-turbo",messages:e.state.chats}));case 2:t=c.sent,n=t.data.choices[0].message.content,r={role:"assistant",content:n},e.setState((function(e){return{chats:[].concat((0,a.default)(e.chats),[r])}}));case 6:case"end":return c.stop()}}),null,null,null,Promise)})));case 2:case"end":return r.stop()}}),null,null,null,Promise)},e}return(0,c.default)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.url,a=t.extractedData,r=t.chatInput,c=t.chats,s=t.placeholder,o=t.isDataExtracted;return f.createElement("div",{className:"PygPal l-container"},f.createElement("div",{className:"PygPal-extractURL"},f.createElement("input",{className:"PygPal-extractDataInput",type:"text",value:n,onChange:function(t){return e.setState({url:t.target.value})},placeholder:"Enter a URL"}),f.createElement("button",{onClick:this.handleUrlSubmit,type:"submit"},"Extract Data")),o&&f.createElement("div",{className:"PygPal-bottomSection"},a&&a.paragraphs&&f.createElement("div",{className:"PygPal-extractedData"},f.createElement("h2",null,"Extracted Data"),f.createElement("ul",null,a.paragraphs.map((function(e,t){return f.createElement("li",{key:t},e)})))),f.createElement("div",{className:"PygPal-chatInterface"},f.createElement("div",{className:"PygPal-chatHistory"},f.createElement("h2",null,"Chat History"),f.createElement("ul",{className:"PygPal-chatHistoryList"},c.slice(1).map((function(e,t){return f.createElement("li",{className:"PygPal-chatHistoryList-li",key:t},e.role,": ",e.content)})))),f.createElement("input",{className:"PygPal-messageInput",type:"text",value:r,onChange:function(t){return e.setState({chatInput:t.target.value})},placeholder:s}),f.createElement("button",{type:"submit",onClick:this.handleSendMessage},"Send"))))}}]),n}(f.Component);const P=v},7586:(e,t,n)=>{n.r(t),n.d(t,{default:()=>o});var a=n(3144),r=n(5671),c=n(2805),s=n.n(c);const o=new((0,a.default)((function e(){(0,r.default)(this,e),this.getScripts=function(){return new Promise((function(e){s().database().ref("/scripts/").once("value").then((function(t){t.val()?e(Object.values(t.val())):e({})}))}))},this.getFylds=function(){return new Promise((function(e){s().database().ref("/fylds/").once("value").then((function(t){t.val()?e(Object.values(t.val())):e({})}))}))},this.createFyld=function(e){return new Promise((function(t){s().database().ref("/fylds/"+e.name.replace(/\s/g,"")+"/").set({name:e.name,dateCreated:e.dateCreated,description:e.description,image:e.image,friends:e.friends}).then((function(e){console.log("response",e),t(!0)})).catch((function(e){console.log("error",e)}))}))},this.createGrypcht=function(e){return new Promise((function(t){s().database().ref("/grypchts/"+e.id+"/").set({id:e.id,groupName:e.groupName,members:e.members,dateCreated:e.dateCreated,description:e.description,isPrivateGrypcht:e.isPrivateGrypcht}).then((function(e){console.log("response",e),t(!0)})).catch((function(e){console.log("error",e)}))}))},this.createNewScript=function(e){return new Promise((function(t){s().database().ref("/scripts/"+e.id+"/").set({id:e.id,name:e.name,dateCreated:e.dateCreated,cast:e.cast,crew:e.crew,messages:e.messages,isPrivateScript:e.isPrivateScript}).then((function(e){console.log("response",e),t(!0)})).catch((function(e){console.log("error",e)}))}))},this.updateScript=function(e){return new Promise((function(t){s().database().ref("/scripts/"+e.id+"/").update({id:e.id,name:e.name,dateCreated:e.dateCreated,cast:e.cast,crew:e.crew,messages:e.messages,scenes:e.scenes,readerReactionMap:e.readerReactionMap,isPrivateScript:e.isPrivateScript}).then((function(e){console.log("response",e),t(!0)})).catch((function(e){console.log("error",e)}))}))},this.getOpenAIAPI=function(){return new Promise((function(e){s().database().ref("/openAIAPI/").once("value").then((function(t){t.val()?e(Object.values(t.val())):e({})}))}))},this.getConversationHistory=function(){return new Promise((function(e){s().database().ref("/conversationHistory/").once("value").then((function(t){t.val()?e(Object.values(t.val())):e({})}))}))},this.getRimiSenTitles=function(){return new Promise((function(e){s().database().ref("/rimiLyrics/").once("value").then((function(t){t.val()?e(Object.values(t.val())):e({})}))}))},this.postChats=function(e,t,n,a,r){return new Promise((function(c){s().database().ref("/chats/"+e+"/"+a+"/"+t+"/").push({content:n,timestamp:Date.now(),uid:r}).then((function(){c(!0)})).catch((function(e){c({})}))}))},this.storage=function(){return s().storage()},this.getRimiSenTitles=function(){return new Promise((function(e){s().database().ref("/rimiLyrics/").once("value").then((function(t){t.val()?e(Object.values(t.val())):e({})}))}))},this.getScriptById=function(e){return new Promise((function(t){s().database().ref("/scripts/"+e).once("value").then((function(e){e.val()?t(Object(e.val())):t({})}))}))},this.updateSenTitle=function(e){return new Promise((function(t){s().database().ref("/rimis/"+e.id+"/").update({senTitle:e.newSenTitle}).then((function(n){return new Promise((function(t){s().database().ref("/rimis/"+e.id+"/updates/"+e.updateId).remove().then((function(){t(!0)})).catch((function(e){console.log("error",e)}))})).then((function(e){t(!0)})).catch((function(e){console.log("error",e)}))})).catch((function(e){console.log("error",e)}))}))},this.sendForApproval=function(e){return new Promise((function(t){s().database().ref("/rimis/"+e.id+"/updates/"+e.updateId+"/").set(e).then((function(e){console.log("response",e),t(!0)})).catch((function(e){console.log("error",e)}))}))},this.updateVideoSnippetURL=function(e,t){return new Promise((function(n){s().database().ref("/orders/"+e+"/").update({snippetVideoURL:t}).then((function(e){console.log("response",e),n(!0)})).catch((function(e){console.log("error",e)}))}))}})))}}]);
//# sourceMappingURL=601.1127fb17.chunk.js.map